Summary,Issue Type,Description,Story Points,Labels,Priority,Epic Link
"[DB] Crear tabla users",Task,"Crear tabla users con campos: id PK, username UNIQUE, email UNIQUE, password_hash, display_name, avatar_url, role ENUM, community_id FK, created_at, updated_at. Índices: idx_users_email, idx_users_community_id",3,"db,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[DB] Crear tabla communities",Task,"Crear tabla communities con campos: id PK, code UNIQUE VARCHAR(10), name VARCHAR(100), created_at. Índice: idx_communities_code",2,"db,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[DB] Crear tabla categories",Task,"Crear tabla categories con campos: id PK, slug UNIQUE VARCHAR(50), name VARCHAR(100). Índice: idx_categories_slug",2,"db,backend","Medium","S4 - Modelado y API (DER + OpenAPI)"
"[DB] Crear tabla themes",Task,"Crear tabla themes con campos: id PK, title VARCHAR(150), description TEXT, start_date DATE, end_date DATE, is_active BOOLEAN, created_at. Índices: idx_themes_is_active, idx_themes_dates",3,"db,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[DB] Crear tabla photos",Task,"Crear tabla photos con campos: id PK, user_id FK, theme_id FK, community_id FK, category_id FK nullable, title VARCHAR(150), description TEXT, image_url VARCHAR(1000), thumb_url VARCHAR(1000), is_moderated BOOLEAN, is_deleted BOOLEAN, created_at. Constraint UNIQUE(user_id, theme_id). Índices: idx_photos_user_id, idx_photos_theme_id, idx_photos_community_id, idx_photos_created_at",5,"db,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[DB] Crear tabla votes",Task,"Crear tabla votes con campos: id PK, photo_id FK, user_id FK, created_at. Constraint UNIQUE(photo_id, user_id). Índices: idx_votes_photo_id, idx_votes_user_id, idx_votes_photo_user",3,"db,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[DB] Crear tabla moderations",Task,"Crear tabla moderations con campos: id PK, photo_id FK, moderator_id FK, action ENUM('removed','flagged','approved'), reason TEXT, created_at. Índices: idx_moderations_photo_id, idx_moderations_moderator_id",2,"db,backend","Low","S4 - Modelado y API (DER + OpenAPI)"
"[DB] Crear tabla notifications",Task,"Crear tabla notifications con campos: id PK, user_id FK, type VARCHAR(50), payload JSON, is_read BOOLEAN, created_at. Índices: idx_notifications_user_id, idx_notifications_is_read",2,"db,backend","Low","S4 - Modelado y API (DER + OpenAPI)"
"[DB] Crear tabla winners",Task,"Crear tabla winners con campos: id PK, theme_id FK, community_id FK, photo_id FK, position INT, votes_count INT, awarded_at TIMESTAMP. Índices: idx_winners_theme_id, idx_winners_community_id",2,"db,backend","Low","S4 - Modelado y API (DER + OpenAPI)"
"[DB] Configurar foreign keys y cascadas",Task,"Definir todas las relaciones FK con ON DELETE CASCADE/ RESTRICT según corresponda. Validar integridad referencial",2,"db,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[API] POST /auth/register",Task,"Implementar registro: validar datos (username, email, password), hashear password con bcrypt, crear usuario en DB, generar JWT, devolver AuthResponse DTO. Manejar errores: VALIDATION_ERROR, USER_EXISTS",5,"api,auth,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[API] POST /auth/login",Task,"Implementar login: validar credenciales, verificar password con bcrypt, generar JWT con expiración, devolver AuthResponse DTO. Manejar errores: VALIDATION_ERROR, AUTH_REQUIRED",5,"api,auth,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[API] Middleware de autenticación JWT",Task,"Crear middleware para validar Bearer token, extraer user_id del payload, añadir req.user. Manejar errores: AUTH_REQUIRED, TOKEN_EXPIRED, TOKEN_INVALID",3,"api,auth,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[API] GET /users/me",Task,"Endpoint para obtener perfil del usuario autenticado. Usar middleware auth, mapear a User DTO. Manejar errores: AUTH_REQUIRED",2,"api,users,backend","Medium","S4 - Modelado y API (DER + OpenAPI)"
"[API] GET /photos",Task,"Endpoint listar fotos: paginación (page, limit), filtros (community_id, theme_id, category_id, user_id), ordenar por created_at DESC, mapear a PaginatedPhotos DTO. Validar parámetros de paginación",5,"api,photos,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[API] POST /photos",Task,"Endpoint upload: validar multipart/form-data, validar imagen (tipo, tamaño), subir a Cloudinary, generar thumb_url, guardar metadata en DB, mapear a Photo DTO. Manejar errores: VALIDATION_ERROR, FILE_TOO_LARGE, AUTH_REQUIRED",8,"api,photos,cloudinary,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[API] GET /photos/{id}",Task,"Endpoint obtener foto por ID: incluir relaciones (user, theme, category), calcular votes_count, verificar si usuario autenticado votó (has_user_voted), mapear a PhotoDetail DTO. Manejar errores: PHOTO_NOT_FOUND",3,"api,photos,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[API] DELETE /photos/{id}",Task,"Endpoint eliminar foto: verificar propiedad (solo owner), soft delete (is_deleted=true), devolver 204. Manejar errores: AUTH_REQUIRED, FORBIDDEN, PHOTO_NOT_FOUND",3,"api,photos,backend","Medium","S4 - Modelado y API (DER + OpenAPI)"
"[API] GET /themes",Task,"Endpoint listar temas: paginación, filtro is_active, filtro community_id, mapear a lista de Theme DTO. Validar parámetros",3,"api,themes,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[API] POST /themes",Task,"Endpoint crear tema: validar datos (title, dates), verificar rol admin, crear en DB, mapear a Theme DTO. Manejar errores: VALIDATION_ERROR, AUTH_REQUIRED, FORBIDDEN",5,"api,themes,backend","Medium","S4 - Modelado y API (DER + OpenAPI)"
"[API] GET /themes/{id}",Task,"Endpoint obtener tema por ID, mapear a Theme DTO. Manejar errores: THEME_NOT_FOUND",2,"api,themes,backend","Medium","S4 - Modelado y API (DER + OpenAPI)"
"[API] GET /communities",Task,"Endpoint listar comunidades: paginación, mapear a lista de Community DTO. Validar parámetros",2,"api,communities,backend","Medium","S4 - Modelado y API (DER + OpenAPI)"
"[API] GET /communities/{id}",Task,"Endpoint obtener comunidad por ID, mapear a Community DTO. Manejar errores: COMMUNITY_NOT_FOUND",2,"api,communities,backend","Medium","S4 - Modelado y API (DER + OpenAPI)"
"[API] GET /categories",Task,"Endpoint listar categorías: sin paginación, mapear a lista de Category DTO",2,"api,categories,backend","Low","S4 - Modelado y API (DER + OpenAPI)"
"[API] POST /votes",Task,"Endpoint votar foto: validar photo_id existe, verificar no ha votado (constraint UNIQUE), crear voto en DB, mapear a Vote DTO. Manejar errores: VALIDATION_ERROR, ALREADY_VOTED, PHOTO_NOT_FOUND, AUTH_REQUIRED",5,"api,votes,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[API] DELETE /votes",Task,"Endpoint eliminar voto: buscar voto por photo_id y user_id, eliminar de DB, devolver 204. Manejar errores: AUTH_REQUIRED, VOTE_NOT_FOUND",3,"api,votes,backend","Medium","S4 - Modelado y API (DER + OpenAPI)"
"[API] DTOs y mappers",Task,"Crear DTOs para todas las entidades (User, Photo, Theme, Community, Category, Vote, AuthResponse, PaginatedResponse). Implementar funciones mapper DB -> DTO. Validar campos requeridos",5,"api,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[API] Manejo centralizado de errores",Task,"Crear middleware de errores: capturar excepciones, mapear a formato Error estándar (code, message, details), códigos HTTP correctos. Logging de errores",3,"api,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[API] Validaciones de entrada",Task,"Implementar validaciones para todos los endpoints: tipos de datos, rangos, formatos (email, dates), constraints de negocio. Usar librería de validación (joi/express-validator)",5,"api,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[INT] Integración Cloudinary",Task,"Configurar SDK Cloudinary: credenciales desde env, función upload con transformaciones (thumb), manejo de errores de API externa, retry logic",5,"integration,cloudinary,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[INT] Configuración JWT",Task,"Configurar librería JWT: secret desde env, expiración configurable, payload estándar (user_id, email, role). Función generar/verificar token",3,"integration,auth,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[TEST] Tests unitarios - Auth",Task,"Tests para registro y login: casos exitosos, validaciones, errores (email duplicado, credenciales inválidas). Mock de DB y bcrypt",5,"test,unit,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[TEST] Tests unitarios - Photos",Task,"Tests para endpoints de fotos: listar, crear, obtener, eliminar. Mock de Cloudinary y DB. Validar DTOs y paginación",8,"test,unit,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[TEST] Tests unitarios - Votes",Task,"Tests para votar y eliminar voto: casos exitosos, constraint UNIQUE, errores. Mock de DB",3,"test,unit,backend","Medium","S4 - Modelado y API (DER + OpenAPI)"
"[TEST] Tests de integración - DB",Task,"Tests de integración con DB real (test DB): CRUD completo de entidades, relaciones FK, constraints. Setup/teardown de datos de prueba",5,"test,integration,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[TEST] Tests de integración - API",Task,"Tests end-to-end de endpoints: flujo completo auth -> crear foto -> votar. Usar servidor de test, DB de test. Validar respuestas HTTP y DTOs",8,"test,integration,api,backend","High","S4 - Modelado y API (DER + OpenAPI)"
"[TEST] Tests de contrato - Postman",Task,"Crear colección Postman con casos críticos: registro, login, listar fotos, crear foto, votar. Validar schemas OpenAPI. Ejecutar en CI/CD",5,"test,contract,postman","Medium","S4 - Modelado y API (DER + OpenAPI)"
"[TEST] Datasets de prueba",Task,"Crear scripts SQL con datos de prueba: usuarios, comunidades, temas, fotos, votos. Datos realistas para desarrollo y testing",3,"test,data,backend","Medium","S4 - Modelado y API (DER + OpenAPI)"
